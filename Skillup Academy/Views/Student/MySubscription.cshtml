@using Skillup_Academy.ViewModels.StudentsViewModels
@model StudentSubscriptionViewModel

<style>
    .page-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 40px;
        border-radius: 20px;
        color: white;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }

        .page-header h2 {
            margin: 0;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 15px;
        }

    .subscription-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }

    .card-header-custom {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 30px;
        color: white;
        text-align: center;
    }

    .plan-name {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 10px;
    }

    .plan-status {
        display: inline-block;
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 14px;
        font-weight: 600;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
    }

    .card-body-custom {
        padding: 40px;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
    }

    .info-item {
        background: #f8fafc;
        padding: 20px;
        border-radius: 15px;
        border-left: 4px solid #667eea;
        transition: all 0.3s ease;
    }

        .info-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        }

    .info-label {
        font-size: 13px;
        color: #64748b;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .info-value {
        font-size: 20px;
        color: #2d3748;
        font-weight: 700;
    }

    .status-active {
        color: #22c55e;
    }

    .status-expired {
        color: #ef4444;
    }

    .timeline {
        position: relative;
        padding: 30px 0;
        margin: 30px 0;
    }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            transform: translateX(-50%);
        }

    .timeline-item {
        display: flex;
        align-items: center;
        margin-bottom: 30px;
        position: relative;
    }

    .timeline-date {
        flex: 1;
        text-align: right;
        padding-right: 30px;
    }

    .timeline-date-label {
        font-size: 12px;
        color: #64748b;
        font-weight: 600;
        text-transform: uppercase;
    }

    .timeline-date-value {
        font-size: 18px;
        color: #2d3748;
        font-weight: 700;
        margin-top: 5px;
    }

    .timeline-dot {
        width: 20px;
        height: 20px;
        background: white;
        border: 4px solid #667eea;
        border-radius: 50%;
        position: relative;
        z-index: 2;
    }

    .timeline-content {
        flex: 1;
        padding-left: 30px;
    }

    .progress-container {
        background: #f8fafc;
        padding: 25px;
        border-radius: 15px;
        margin-top: 30px;
    }

    .progress-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
    }

    .progress-text {
        font-size: 14px;
        color: #64748b;
        font-weight: 600;
    }

    .progress-percentage {
        font-size: 14px;
        color: #667eea;
        font-weight: 700;
    }

    .progress-bar-custom {
        height: 12px;
        background: #e2e8f0;
        border-radius: 10px;
        overflow: hidden;
    }

    .progress-bar-fill-custom {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        transition: width 1s ease;
    }

    .action-buttons {
        display: flex;
        gap: 15px;
        margin-top: 30px;
    }

    .btn-custom {
        flex: 1;
        padding: 15px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 16px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        text-decoration: none;
    }

    .btn-primary-custom {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            color: white;
        }

    .btn-outline-custom {
        background: transparent;
        border: 2px solid #667eea;
        color: #667eea;
    }

        .btn-outline-custom:hover {
            background: #667eea;
            color: white;
        }

    .empty-state {
        text-align: center;
        padding: 80px 40px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }

    .empty-icon {
        width: 150px;
        height: 150px;
        margin: 0 auto 30px;
        background: linear-gradient(135deg, #e0e7ff 0%, #f3e8ff 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .empty-title {
        font-size: 28px;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 15px;
    }

    .empty-description {
        color: #64748b;
        font-size: 16px;
        margin-bottom: 30px;
        line-height: 1.6;
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }

    .feature-item {
        background: #f8fafc;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
    }

    .feature-icon {
        width: 50px;
        height: 50px;
        margin: 0 auto 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }

    .feature-title {
        font-size: 14px;
        color: #64748b;
        font-weight: 600;
    }

    @@media (max-width: 768px) {
        .timeline::before

    {
        left: 20px;
    }

    .timeline-item {
        flex-direction: column;
        align-items: flex-start;
        padding-left: 50px;
    }

    .timeline-date {
        text-align: left;
        padding-right: 0;
        margin-bottom: 10px;
    }

    .timeline-dot {
        position: absolute;
        left: 11px;
    }

    .timeline-content {
        padding-left: 0;
    }

    .action-buttons {
        flex-direction: column;
    }

    }
</style>
<div class="container my-3">

<div class="page-header">
    <h2>
        <svg width="32" height="32" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" />
        </svg>
        My Subscription
    </h2>
</div>

@if (Model == null)
{
    <div class="empty-state">
        <div class="empty-icon">
            <svg width="80" height="80" viewBox="0 0 20 20" fill="#667eea">
                <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd" />
            </svg>
        </div>
        <h3 class="empty-title">No Active Subscription</h3>
        <p class="empty-description">
            You don't have an active subscription yet. Subscribe now to unlock premium features<br />
            and get access to unlimited courses!
        </p>

        <div class="features-grid">
            <div class="feature-item">
                <div class="feature-icon">
                    <svg width="28" height="28" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z" />
                    </svg>
                </div>
                <p class="feature-title">Unlimited Courses</p>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <svg width="28" height="28" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                    </svg>
                </div>
                <p class="feature-title">Certificates</p>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <svg width="28" height="28" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
                    </svg>
                </div>
                <p class="feature-title">24/7 Support</p>
            </div>
            <div class="feature-item">
                <div class="feature-icon">
                    <svg width="28" height="28" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z" />
                    </svg>
                </div>
                <p class="feature-title">HD Videos</p>
            </div>
        </div>

        <a asp-controller="Subscription" asp-action="ShowAllPlanInHome" class="btn-custom btn-primary-custom" style="max-width: 300px; margin: 0 auto;">
            <svg width="24" height="24" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
            </svg>
            View Subscription Plans
        </a>
    </div>
}
else
{
    var daysRemaining = (Model.EndDate - DateTime.Now).Days;
    var totalDays = (Model.EndDate - Model.StartDate).Days;
    var daysElapsed = (DateTime.Now - Model.StartDate).Days;
    var progressPercentage = totalDays > 0 ? Math.Min((double)daysElapsed / totalDays * 100, 100) : 0;

    <div class="subscription-card">
        <div class="card-header-custom">
            <div class="plan-name">@Model.SubscriptionName</div>
            <div class="plan-status">
                @if (Model.IsActive)
                {
                    <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor" style="display: inline; margin-right: 5px;">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                    </svg>
                    <span>Active Subscription</span>
                }
                else
                {
                    <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor" style="display: inline; margin-right: 5px;">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                    </svg>
                    <span>Expired</span>
                }
            </div>
        </div>

        <div class="card-body-custom">
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
                        </svg>
                        Days Remaining
                    </div>
                    <div class="info-value" style="color: @(daysRemaining > 7 ? "#22c55e" : "#ef4444")">
                        @(daysRemaining > 0 ? daysRemaining : 0) Days
                    </div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z" />
                        </svg>
                        Max Courses
                    </div>
                    <div class="info-value">@Model.MaxCourses</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z" />
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd" />
                        </svg>
                        Amount Paid
                    </div>
                    <div class="info-value">@Model.PaidAmount EGP</div>
                </div>

                <div class="info-item">
                    <div class="info-label">
                        <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
                        </svg>
                        Transaction ID
                    </div>
                    <div class="info-value" style="font-size: 14px; word-break: break-all;">
                        @Model.TransactionId
                    </div>
                </div>
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">
                        <div class="timeline-date-label">Start Date</div>
                        <div class="timeline-date-value">@Model.StartDate.ToString("MMM dd, yyyy")</div>
                    </div>
                    <div class="timeline-dot"></div>
                    <div class="timeline-content"></div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">
                        <div class="timeline-date-label">End Date</div>
                        <div class="timeline-date-value">@Model.EndDate.ToString("MMM dd, yyyy")</div>
                    </div>
                    <div class="timeline-dot"></div>
                    <div class="timeline-content"></div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-label">
                    <span class="progress-text">Subscription Period</span>
                    <span class="progress-percentage">@Math.Round(progressPercentage)%</span>
                </div>
                <div class="progress-bar-custom">
                    <div class="progress-bar-fill-custom" style="width: @progressPercentage%"></div>
                </div>
            </div>

            <div class="action-buttons">
                <a asp-controller="Course" asp-action="AllCaurseIsPublished" class="btn-custom btn-primary-custom">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z" />
                    </svg>
                    Browse Courses
                </a>
                <a asp-controller="Subscription" asp-action="ShowAllPlanInHome" class="btn-custom btn-outline-custom">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />
                    </svg>
                    Renew / Upgrade
                </a>
            </div>
        </div>
    </div>
}
</div>
<script>
    // Animate progress bar on load
    window.addEventListener('load', function() {
        const progressBar = document.querySelector('.progress-bar-fill-custom');
        if (progressBar) {
            progressBar.style.width = '0%';
            setTimeout(() => {
                progressBar.style.width = progressBar.getAttribute('style').match(/width:\s*(\d+\.?\d*)%/)[1] + '%';
            }, 100);
        }
    });
</script>